<!DOCTYPE html>
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.5/socket.io.min.js"></script>
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="/cookie.js"></script>


<form action="">
  <input id="n" type="hidden" value=""> 
  <input id="m" autocomplete="off" required>
  <input type="submit" value="Send">
</form>

<ul id="messages"></ul>

<script type="text/javascript" charset="utf-8">
  var socket = io();
  var uname = $.cookie("uname");
  var uid = $.cookie("uid");  
  console.log($.cookie());
  console.log($.cookie("uname"));

  socket.emit('join lobby', uname, uid);

  socket.on('join lobby', function(player){
      $('#players').append($('<li id="' + player + '">').text(player));
  });

  socket.on('leave lobby', function(player){
      $('#' + player).remove();
  });
  
  socket.on('lobby message', function(msg){
      $('#messages').append($('<li>').text(msg));
  });

  $(document).ready(function () {
      $('#n').val(uname);
  });

  
  $('form').submit(function(){
      socket.emit('lobby message', uname + ": " + $('#m').val());
      console.log($('#m').val());
      $('#m').val('');
      return false;
  });
</script>
